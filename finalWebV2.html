<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Guidance Job Board</title>
    <style>
        :root {
            /* Dark theme (default) */
            --primary-color: #64ffda;
            --background-color: #0a192f;
            --secondary-color: #112240;
            --accent-color: #233554;
            --text-color: #ccd6f6;
            --button-text: #0a192f;
            --border-color: #64ffda;
            --heading-color: #64ffda;
            --font-sans: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Ubuntu, 'Helvetica Neue', sans-serif;
            --font-mono: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        :root[data-theme='light'] {
            --primary-color: #0a192f;
            --background-color: #ffffff;
            --secondary-color: #f8f9fa;
            --accent-color: #e9ecef;
            --text-color: #1a202c;
            --button-text: #ffffff;
            --border-color: #0a192f;
            --heading-color: #0a192f;
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            line-height: 1.6;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.show {
            opacity: 1;
        }
        .container {
            position: relative;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        h1 {
            color: var(--heading-color);
            text-align: center;
            font-size: 2.5rem;
            font-weight: 700;
            margin: 2rem 0;
            letter-spacing: -0.025em;
        }
        .form-container {
            background-color: var(--secondary-color);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(var(--border-color), 0.1);
        }
        input, textarea, select {
            width: 100%;
            padding: 0.75rem 1rem;
            margin: 0.5rem 0;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--background-color);
            color: var(--text-color);
            font-family: var(--font-sans);
            font-size: 1rem;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(var(--primary-color), 0.1);
        }
        button {
            background-color: var(--primary-color);
            color: var(--button-text);
            font-weight: 600;
            cursor: pointer;
            padding: 0.75rem 1.5rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        button:hover {
            background-color: transparent;
            color: var(--primary-color);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        button:active {
            transform: translateY(0);
            box-shadow: var(--shadow-sm);
        }
        .posting {
            background-color: var(--secondary-color);
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1rem 0;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(var(--border-color), 0.1);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .posting:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        .posting h3 {
            color: var(--heading-color);
            margin-top: 0;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .posting p {
            margin: 0.75rem 0;
            line-height: 1.6;
        }

        .posting strong {
            color: var(--primary-color);
        }
        #admin-view {
            background-color: var(--secondary-color);
            padding: 2rem;
            border-radius: 16px;
            margin-top: 2rem;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(var(--border-color), 0.1);
        }
        
        #pendingApplications {
            margin-top: 2rem;
            padding: 2rem;
            background-color: var(--accent-color);
            border-radius: 16px;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(var(--border-color), 0.1);
        }
        
        #pendingApplications .posting {
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }
        .toggle-switch {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background-color: var(--accent-color);
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            z-index: 1000;
        }
        .toggle-switch input[type="checkbox"] {
            appearance: none;
            width: 44px;
            height: 24px;
            background-color: var(--secondary-color);
            border-radius: 9999px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid var(--primary-color);
            margin: 0;
        }
        .toggle-switch input[type="checkbox"]:checked {
            background-color: var(--accent-color);
        }
        .toggle-switch input[type="checkbox"]::before {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: var(--primary-color);
            left: 2px;
            top: 2px;
            transition: transform 0.3s ease, background-color 0.3s ease;
            box-shadow: var(--shadow-sm);
        }
        .toggle-switch input[type="checkbox"]:checked::before {
            transform: translateX(20px);
            background-color: var(--primary-color);
        }
        .toggle-switch label {
            color: var(--text-color);
            font-weight: 500;
            margin: 0;
            user-select: none;
        }
        #adminToggle:checked ~ .admin-panel {
            display: block;
        }
        .form-container, .posting, .admin-panel, #pendingApplications {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .form-container:hover, .posting:hover, .admin-panel:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        button {
            transition: all 0.3s ease;
        }
        button:hover {
            transform: scale(1.05);
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--primary-color);
        }
        .back-link {
            display: inline-block;
            margin-top: 20px;
            color: var(--primary-color);
            text-decoration: none;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .view {
            display: none;
        }
        .view.active {
            display: block;
        }
        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .nav-buttons button {
            background-color: transparent;
            color: var(--text-color);
            border: 2px solid var(--primary-color);
            font-weight: 600;
            min-width: 120px;
        }

        .nav-buttons button:hover {
            background-color: var(--primary-color);
            color: var(--button-text);
        }
        .nav-buttons button {
            width: auto;
            padding: 8px 15px;
        }
        
        /* Modal content styles */
        .modal-content {
            background-color: var(--secondary-color);
            margin: 5% auto;
            padding: 2rem;
            border: 1px solid var(--border-color);
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            box-shadow: var(--shadow-lg);
            animation: modalFadeIn 0.3s;
            position: relative;
        }
        
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--primary-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .modal-header h2 {
            color: var(--primary-color);
            margin: 0;
        }
        
        .close-modal {
            color: var(--primary-color);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            background: none;
            border: none;
            padding: 0;
            width: auto;
        }
        
        .close-modal:hover {
            color: #fff;
        }
        
        .application-form .form-group {
            margin-bottom: 15px;
        }
        
        .application-form label {
            display: block;
            margin-bottom: 5px;
            color: var(--primary-color);
        }
        
        .application-form input[type="file"] {
            padding: 5px;
        }
        
        .application-success {
            text-align: center;
            padding: 20px;
            display: none;
        }
        
        .application-success h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="toggle-switch">
            <input type="checkbox" id="themeToggle">
            <label for="themeToggle">Dark Mode</label>
        </div>
        <h1>School Guidance Job Board</h1>
        
        <div class="nav-buttons">
            <button onclick="showView('main-view')">Job Listings</button>
            <button onclick="showView('post-job-view')">Post a Job</button>
            <button onclick="showView('admin-view')">Admin Panel</button>
        </div>
        
        <!-- Main View (Job Listings) -->
        <div id="main-view" class="view active">
            <!-- Search Bar -->
            <div class="form-container">
                <div class="form-group">
                    <label for="searchInput">Search Jobs</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="searchInput" placeholder="Search by title, company, or description..." oninput="searchJobs()">
                        <button onclick="searchJobs()" style="width: auto;">Search</button>
                    </div>
                </div>
            </div>
            <!-- Approved Job Postings -->
            <div id="jobListings">
                <h2>Available Job Postings</h2>
                <!-- Job postings will be dynamically inserted here -->
            </div>
        </div>
        
        <!-- Post Job View -->
        <div id="post-job-view" class="view">
            <h2>Post a Job</h2>
            <form id="postJobForm">
                <div class="form-group">
                    <label for="postJobTitle">Job Title</label>
                    <input type="text" id="postJobTitle" required>
                </div>
                <div class="form-group">
                    <label for="postJobDescription">Job Description</label>
                    <textarea id="postJobDescription" required></textarea>
                </div>
                <div class="form-group">
                    <label for="postCompanyName">Company Name</label>
                    <input type="text" id="postCompanyName" required>
                </div>
                <div class="form-group">
                    <label for="postContactEmail">Contact Email</label>
                    <input type="email" id="postContactEmail" required>
                </div>
                <button type="submit">Submit Job</button>
            </form>
        </div>
        
        <!-- Admin View -->
        <div id="admin-view" class="view">
            <h2>Admin Panel</h2>
            <div class="search-container">
                <div class="search-box">
                    <input type="text" id="adminSearchInput" placeholder="Search by title, company, or description..." oninput="debounce(searchAdminPostings, 300)()">
                    <button onclick="searchAdminPostings()" style="width: auto;">Search</button>
                </div>
            </div>
            <div id="pendingApprovals">
                <h3>Pending Approvals</h3>
                <!-- Pending job postings will be dynamically inserted here -->
            </div>
            <div id="approvedPostings">
                <h3>Approved Postings</h3>
                <!-- Approved job postings will be dynamically inserted here -->
            </div>
            <div id="pendingApplications">
                <h3>Pending Applications</h3>
                <!-- Pending job applications will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- Application Modal -->
    <div id="applicationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalJobTitle">Apply for Position</h2>
                <button class="close-modal" onclick="closeApplicationModal()">&times;</button>
            </div>
            <div id="applicationFormContainer">
                <form id="applicationForm" class="application-form">
                    <input type="hidden" id="jobId">
                    <div class="form-group">
                        <label for="applicantName">Full Name</label>
                        <input type="text" id="applicantName" required>
                    </div>
                    <div class="form-group">
                        <label for="applicantEmail">Email Address</label>
                        <input type="email" id="applicantEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="applicantPhone">Phone Number</label>
                        <input type="tel" id="applicantPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="applicantResume">Resume (PDF or Word)</label>
                        <input type="file" id="applicantResume" accept=".pdf,.doc,.docx">
                    </div>
                    <div class="form-group">
                        <label for="coverLetter">Why are you interested in this position?</label>
                        <textarea id="coverLetter" rows="5" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="heardAbout">How did you hear about this position?</label>
                        <select id="heardAbout" required>
                            <option value="">Please select</option>
                            <option value="school">School Counselor</option>
                            <option value="friend">Friend or Family</option>
                            <option value="social">Social Media</option>
                            <option value="search">Search Engine</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <button type="submit">Submit Application</button>
                </form>
            </div>
            <div id="applicationSuccess" class="application-success">
                <h3>Application Submitted!</h3>
                <p>Thank you for your interest. Your application has been received.</p>
                <p>We will contact you if your qualifications match our requirements.</p>
                <button onclick="closeApplicationModal()">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Theme management
        const AI_CONFIG = {
            matchThreshold: 0.5, // Lowered threshold for better matching
            keywordWeight: 0.4, // Increased keyword weight
            skillsWeight: 0.4, // Adjusted skills weight
            experienceWeight: 0.2,
            minKeywordLength: 3,
            maxNGramSize: 3,
            commonTechKeywords: new Set([
                'javascript', 'python', 'java', 'react', 'angular', 'vue', 'node', 'express',
                'sql', 'nosql', 'mongodb', 'aws', 'azure', 'docker', 'kubernetes', 'devops',
                'frontend', 'backend', 'fullstack', 'web', 'mobile', 'cloud', 'api', 'rest',
                'graphql', 'microservices', 'agile', 'scrum', 'git', 'ci/cd', 'machine learning',
                'data science', 'artificial intelligence', 'nlp', 'deep learning', 'tensorflow',
                'pytorch', 'computer vision', 'data analytics', 'big data', 'data mining',
                'education', 'teaching', 'counseling', 'guidance', 'curriculum', 'assessment',
                'instruction', 'learning', 'pedagogy', 'classroom', 'school', 'student', 'teacher'
            ]),
            skillLevels: {
                'beginner': 0.8, // Increased base values
                'intermediate': 1.0,
                'advanced': 1.3,
                'expert': 1.7
            },
            contextWeight: 0.3 // Increased context weight
        };

        // AI Utility Functions
        function extractKeywords(text) {
            const stopWords = new Set([
                'and', 'or', 'the', 'a', 'an', 'in', 'on', 'at', 'to', 'for', 'of', 'with',
                'i', 'we', 'you', 'he', 'she', 'it', 'they', 'am', 'is', 'are', 'was', 'were',
                'be', 'been', 'being', 'have', 'has', 'had', 'do', 'does', 'did', 'will', 'would',
                'can', 'could', 'shall', 'should', 'may', 'might', 'must', 'this', 'that', 'these',
                'those', 'here', 'there', 'when', 'where', 'why', 'how', 'all', 'any', 'both',
                'each', 'few', 'more', 'most', 'other', 'some', 'such', 'what', 'which', 'whose'
            ]);

            // Extract words and clean them
            const words = text.toLowerCase()
                .replace(/[^a-z0-9+#/.\s-]/g, ' ')
                .split(/\s+/)
                .filter(word => word && word.length > 2 && !stopWords.has(word));

            // Identify technical terms and common phrases
            const technicalTerms = words.filter(word => AI_CONFIG.commonTechKeywords.has(word));
            
            // Extract years of experience mentions
            const experienceMatches = text.match(/\d+(?:\.\d+)?\+?\s*(?:year|yr)s?\s*(?:of)?\s*experience/gi) || [];
            
            return {
                keywords: words,
                technicalTerms,
                experienceYears: experienceMatches.map(match => parseInt(match.match(/\d+/)[0]))
            };
        }

        function calculateSkillMatch(jobSkills, candidateSkills) {
            const jobAnalysis = extractKeywords(jobSkills);
            const candidateAnalysis = extractKeywords(candidateSkills);

            // Ensure we don't match empty searches
            if (candidateAnalysis.keywords.length === 0) {
                return {
                    keywords: [],
                    technicalTerms: [],
                    experienceYears: [],
                    keywordScore: 0,
                    techSkillsScore: 0,
                    experienceScore: 0,
                    contextScore: 0
                };
            }

            // Calculate technical skills match with weighted importance and skill level
            const techSkillsMap = new Map();
            jobAnalysis.technicalTerms.forEach(term => {
                const skillLevel = term.match(/\b(beginner|intermediate|advanced|expert)\b/i);
                const baseWeight = skillLevel ? AI_CONFIG.skillLevels[skillLevel[0].toLowerCase()] : 1.0;
                techSkillsMap.set(term.replace(/\b(beginner|intermediate|advanced|expert)\s*/i, ''), baseWeight);
            });

            let techSkillsScore = 0;
            let matchedSkills = 0;
            techSkillsMap.forEach((weight, skill) => {
                if (candidateAnalysis.technicalTerms.includes(skill)) {
                    techSkillsScore += weight;
                    matchedSkills++;
                }
            });
            techSkillsScore = techSkillsMap.size > 0 ? techSkillsScore / techSkillsMap.size : 0.5;

            // Calculate keyword match with enhanced scoring and relevance weighting
            // Count exact matches and partial matches
            const exactMatches = jobAnalysis.keywords.filter(keyword => 
                candidateAnalysis.keywords.includes(keyword)
            ).length;
            
            // Calculate match percentage based on job keywords
            const matchPercentage = jobAnalysis.keywords.length > 0 ? 
                exactMatches / jobAnalysis.keywords.length : 0;
            
            // Apply technical term bonus
            const techTermMatches = jobAnalysis.keywords.filter(keyword => 
                AI_CONFIG.commonTechKeywords.has(keyword) && candidateAnalysis.keywords.includes(keyword)
            ).length;
            
            // Enhanced scoring with higher base values and tech bonus
            const techBonus = techTermMatches > 0 ? 
                Math.min(0.3 * (techTermMatches / Math.max(jobAnalysis.technicalTerms.length, 1)), 0.3) : 0;
            
            // Ensure minimum score is higher than previous algorithm
            const baseScore = Math.max(0.2, matchPercentage);
            const keywordScore = Math.min(baseScore + techBonus, 1.0);

            // Calculate experience match with graduated scaling and normalized bonus
            const jobExpYears = jobAnalysis.experienceYears.length > 0 ? Math.max(...jobAnalysis.experienceYears) : 0;
            const candidateExpYears = candidateAnalysis.experienceYears.length > 0 ? Math.max(...candidateAnalysis.experienceYears) : 0;
            let experienceScore = jobExpYears === 0 ? 0.5 : Math.min(candidateExpYears / Math.max(jobExpYears, 1), 1.0);
            
            // Add bonus for significantly exceeding required experience, but keep within 1.0
            if (candidateExpYears > jobExpYears * 1.5) {
                experienceScore = Math.min(experienceScore * 1.1, 1.0);
            }

            // Calculate context score based on surrounding terms
            const contextScore = calculateContextScore(jobAnalysis.keywords, candidateAnalysis.keywords);

            return {
                techSkillsScore,
                keywordScore,
                experienceScore,
                contextScore,
                matchedSkills
            };
        }

        function calculateContextScore(jobKeywords, candidateKeywords) {
            const windowSize = 4; // Increased window size for better context capture
            let contextScore = 0;
            let contextMatches = 0;
            let technicalMatches = 0;

            // Look for keyword co-occurrences within the sliding window with technical term emphasis
            for (let i = 0; i <= candidateKeywords.length - windowSize; i++) {
                const window = candidateKeywords.slice(i, i + windowSize);
                const matchesInWindow = jobKeywords.filter(keyword => window.includes(keyword));
                
                // Count matches even if there's only one match in the window
                if (matchesInWindow.length > 0) {
                    contextMatches += matchesInWindow.length;
                    // Add bonus for technical term matches with higher weighting
                    technicalMatches += matchesInWindow.filter(term => AI_CONFIG.commonTechKeywords.has(term)).length * 1.5;
                }
            }

            // Calculate final context score with enhanced technical term bonus
            // Use a more generous base score calculation
            const baseContextScore = jobKeywords.length > 0 ? 
                Math.min(contextMatches / (jobKeywords.length * 1.5), 1) : 0.5;
            
            // Increased technical bonus impact
            const technicalBonus = technicalMatches > 0 ? 
                Math.min(technicalMatches / (jobKeywords.length * 0.4), 0.35) : 0;
            
            // Ensure minimum score is higher
            return Math.max(0.15, Math.min(baseContextScore + technicalBonus, 1.0));
        }
        function generateJobSuggestions(application) {
            const postings = getPostings().filter(p => p.approved);
            return postings.map(posting => ({
                job: posting,
                score: calculateJobMatch(posting, application)
            })).sort((a, b) => b.score.overall - a.score.overall);
        }

        function calculateJobMatch(job, application) {
            const matchScores = calculateSkillMatch(job.description, application.coverLetter);
            
            // Normalize individual scores with minimum thresholds to prevent extremely low scores
            const normalizedTechScore = Math.min(Math.max(matchScores.techSkillsScore, 0.15), 1);
            const normalizedKeywordScore = Math.min(Math.max(matchScores.keywordScore, 0.15), 1);
            const normalizedExpScore = Math.min(Math.max(matchScores.experienceScore, 0.15), 1);
            
            // Validate weights sum to 1
            const totalWeight = AI_CONFIG.skillsWeight + AI_CONFIG.keywordWeight + AI_CONFIG.experienceWeight;
            const weightNormalizer = totalWeight === 0 ? 1 : totalWeight;
            
            // Calculate weighted average with validation and apply a minimum threshold
            let overall = (
                normalizedTechScore * (AI_CONFIG.skillsWeight / weightNormalizer) +
                normalizedKeywordScore * (AI_CONFIG.keywordWeight / weightNormalizer) +
                normalizedExpScore * (AI_CONFIG.experienceWeight / weightNormalizer)
            );
            
            // Apply a scaling factor to increase overall scores
            overall = Math.min(overall * 1.2, 1.0);
            
            // Ensure minimum overall score
            overall = Math.max(0.2, overall);

            return {
                techSkillsScore: normalizedTechScore,
                keywordScore: normalizedKeywordScore,
                experienceScore: normalizedExpScore,
                overall
            };
        }

        function calculateRelevance(query, fields) {
            if (!query.trim()) return 1;
            
            const searchTerms = query.toLowerCase().split(/\s+/);
            let totalRelevance = 0;
            let contextualBoost = 0;
            
            fields.forEach(field => {
                if (!field) return;
                const content = field.toLowerCase();
                const words = content.split(/\s+/);
                
                // Calculate TF-IDF like score for each search term
                searchTerms.forEach(term => {
                    const termFreq = words.filter(word => word === term).length;
                    if (termFreq > 0) {
                        const tf = termFreq / words.length;
                        const idf = Math.log(1 + fields.length / fields.filter(f => f && f.toLowerCase().includes(term)).length);
                        totalRelevance += tf * idf;
                        
                        // Boost score for technical terms
                        if (AI_CONFIG.commonTechKeywords.has(term)) {
                            totalRelevance *= 1.2;
                        }
                        
                        // Context window analysis
                        for (let i = 0; i < words.length - 2; i++) {
                            const window = words.slice(i, i + 3);
                            if (window.includes(term)) {
                                const contextTerms = searchTerms.filter(t => t !== term && window.includes(t));
                                contextualBoost += contextTerms.length * 0.1;
                            }
                        }
                    }
                });
            });
            
            // Normalize and apply contextual boost
            const normalizedScore = totalRelevance / (searchTerms.length * fields.length);
            return Math.min(normalizedScore * (1 + contextualBoost), 1);
        }
        /// AI search results
        function enhanceSearchResults(query, results) {
            if (!query.trim()) {
                return results.map(result => ({ ...result, relevance: 1 }));
            }
            
            return results.map(result => ({
                ...result,
                relevance: calculateRelevance(query, [
                    result.title,
                    result.company,
                    result.description
                ])
            })).sort((a, b) => b.relevance - a.relevance);
        }

        // Theme management
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('themeToggle').checked = savedTheme === 'light';
            updateThemeLabel(savedTheme);
        }

        document.getElementById('themeToggle').addEventListener('change', function(e) {
            const theme = e.target.checked ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            updateThemeLabel(theme);
        });

        function updateThemeLabel(theme) {
            const label = document.querySelector('.toggle-switch label');
            label.textContent = theme === 'light' ? 'Dark Mode' : 'Light Mode';
        }

        // Initialize theme and data on page load
        document.addEventListener('DOMContentLoaded', function() {
            initTheme();
            addDemoPostings();
            addDemoApplications();
            renderPostings();
            renderApplications();
        });

        // View management
        function showView(viewId) {
            // Hide all views
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });
            
            // Show selected view
            document.getElementById(viewId).classList.add('active');
        }
        
        // Local storage management
        function getPostings() {
            return JSON.parse(localStorage.getItem('jobPostings')) || [];
        }

        function savePostings(postings) {
            localStorage.setItem('jobPostings', JSON.stringify(postings));
        }

        // Form submission handler for main view - removed as jobForm doesn't exist in this combined version
        
        // Form submission handler for post job view
        document.getElementById('postJobForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const newPosting = {
                id: Date.now(),
                title: document.getElementById('postJobTitle').value,
                description: document.getElementById('postJobDescription').value,
                company: document.getElementById('postCompanyName').value,
                email: document.getElementById('postContactEmail').value,
                approved: false
            };
            const postings = getPostings();
            postings.push(newPosting);
            savePostings(postings);
            this.reset();
            renderPostings();
            showView('main-view'); // Return to main view after submission
        });

        // Rendering functions
        function renderPostings() {
            const postings = getPostings();
            const approvedList = document.getElementById('jobListings');
            const pendingList = document.getElementById('pendingApprovals');
            const adminApprovedList = document.getElementById('approvedPostings');
            const approvedCount = postings.filter(p => p.approved).length;
            const pendingCount = postings.length - approvedCount;
            
            approvedList.innerHTML = `<h2>Available Job Postings (${approvedCount})</h2>`;
            pendingList.innerHTML = `<h3>Pending Approvals (${pendingCount})</h3>`;
            if (adminApprovedList) {
                adminApprovedList.innerHTML = `<h3>Approved Postings (${approvedCount})</h3>`;
            }
            
            // Also render applications when in admin view
            if (document.getElementById('admin-view').classList.contains('active')) {
                renderApplications();
            }

            postings.forEach(posting => {
                // HTML for main job listings view
                const mainPostingHTML = `<div class="posting">
                    <h3>${posting.title}</h3>
                    <p>${posting.description}</p>
                    <p><strong>Company:</strong> ${posting.company}</p>
                    <p><strong>Contact:</strong> ${posting.email}</p>
                    <div class="button-group">
                        ${!posting.approved ? 
                            `<button onclick="approvePosting(${posting.id})">Approve</button>
                            <button onclick="deletePosting(${posting.id})">Delete</button>` : 
                            `<button onclick="openApplicationModal(${posting.id})">Apply Now</button>
                            <button onclick="contactEmployer('${posting.email}')">Contact Employer</button>`
                        }
                    </div>
                </div>`;
                
                // HTML for admin panel with delete buttons for all postings
                const adminPostingHTML = `<div class="posting">
                    <h3>${posting.title}</h3>
                    <p>${posting.description}</p>
                    <p><strong>Company:</strong> ${posting.company}</p>
                    <p><strong>Contact:</strong> ${posting.email}</p>
                    <div class="button-group">
                        ${!posting.approved ? 
                            `<button onclick="approvePosting(${posting.id})">Approve</button>
                            <button onclick="deletePosting(${posting.id})">Delete</button>` : 
                            `<button onclick="deletePosting(${posting.id})">Delete</button>
                            <button onclick="contactEmployer('${posting.email}')">Contact Employer</button>`
                        }
                    </div>
                </div>`;
                
                if (posting.approved) {
                    approvedList.innerHTML += mainPostingHTML;
                    if (adminApprovedList) {
                        adminApprovedList.innerHTML += adminPostingHTML;
                    }
                } else {
                    pendingList.innerHTML += adminPostingHTML;
                }
            });
        }

        // Approval and deletion functions
        function approvePosting(id) {
            const postings = getPostings();
            const postingIndex = postings.findIndex(p => p.id === id);
            if (postingIndex !== -1) {
                postings[postingIndex].approved = true;
                savePostings(postings);
                renderPostings();
            }
        }

        function deletePosting(id) {
            const postings = getPostings();
            const updatedPostings = postings.filter(p => p.id !== id);
            savePostings(updatedPostings);
            renderPostings();
        }

        // Function to add demo postings
        function addDemoApplications() {
            const existingApplications = getApplications();
            
            if (existingApplications.length === 0) {
                const demoPostings = getPostings();
                // Calculate AI scores before saving demo applications
                function calculateDemoApplicationScores(applications) {
                    const demoPostings = getPostings();
                    applications.forEach(application => {
                        const job = demoPostings.find(p => p.id === application.jobId);
                        if (job) {
                            const matchScores = calculateJobMatch(job, application);
                            application.aiAnalysis = {
                                overall: matchScores.overall,
                                techSkillsScore: matchScores.techSkillsScore,
                                experienceScore: matchScores.experienceScore,
                                keywordScore: matchScores.keywordScore
                            };
                        }
                    });
                }

                const demoApplications = [
                    {
                        id: 2000001,
                        jobId: 1000001,
                        name: "John Smith",
                        email: "john.smith@email.com",
                        phone: "555-0123",
                        coverLetter: "Experienced software engineer with 5 years of experience in React, Node.js, and AWS. Led development of scalable web applications and microservices architecture.",
                        status: "pending",
                        dateApplied: Date.now()
                    },
                    {
                        id: 2000002,
                        jobId: 1000002,
                        name: "Sarah Chen",
                        email: "sarah.chen@email.com",
                        phone: "555-0124",
                        coverLetter: "Data scientist with 3 years experience in Python, R, and machine learning. Developed predictive models for customer behavior analysis.",
                        status: "pending",
                        dateApplied: Date.now() - 86400000
                    }
                ];

                // Calculate AI scores for each application
                demoApplications.forEach(application => {
                    const job = demoPostings.find(p => p.id === application.jobId);
                    if (job) {
                        const matchScores = calculateJobMatch(job, application);
                        application.aiAnalysis = {
                            overall: matchScores.overall,
                            techSkillsScore: matchScores.techSkillsScore,
                            experienceScore: matchScores.experienceScore,
                            keywordScore: matchScores.keywordScore
                        };
                    }
                });
                
                calculateDemoApplicationScores(demoApplications);
                saveApplications(demoApplications);
            }
        }

        function addDemoPostings() {
            const existingPostings = getPostings();
            
            // Only add demo postings if there are no existing postings
            if (existingPostings.length === 0) {
                const demoPostings = [
                    {
                        id: 1000001,
                        title: "Software Engineer",
                        description: "Develop and maintain web applications using React, Node.js, and AWS. Collaborate with cross-functional teams to deliver high-quality software solutions.",
                        company: "TechInnovate Inc.",
                        email: "careers@techinnovate.com",
                        approved: true
                    },
                    {
                        id: 1000002,
                        title: "Data Scientist",
                        description: "Analyze large datasets to extract insights and build predictive models. Experience with Python, R, and machine learning frameworks required.",
                        company: "DataVision Analytics",
                        email: "hiring@datavision.io",
                        approved: true
                    },
                    {
                        id: 1000003,
                        title: "UX/UI Designer",
                        description: "Create intuitive and engaging user experiences for web and mobile applications. Proficient in Figma, Adobe XD, and user research methodologies.",
                        company: "DesignWorks Studio",
                        email: "jobs@designworks.com",
                        approved: true
                    },
                    {
                        id: 1000004,
                        title: "School Counselor",
                        description: "Support students' academic and social-emotional development. Develop and implement comprehensive school counseling programs.",
                        company: "Westlake High School",
                        email: "hr@westlake.edu",
                        approved: true
                    },
                    {
                        id: 1000005,
                        title: "Marketing Coordinator",
                        description: "Coordinate marketing campaigns across digital and traditional channels. Manage social media presence and create engaging content.",
                        company: "BrightPath Marketing",
                        email: "careers@brightpath.com",
                        approved: true
                    },
                    {
                        id: 1000006,
                        title: "Product Manager",
                        description: "Lead product development from conception to launch. Define product vision, strategy, and roadmap based on market research and user feedback.",
                        company: "InnovateTech Solutions",
                        email: "pm-hiring@innovatetech.com",
                        approved: false
                    },
                    {
                        id: 1000007,
                        title: "Cybersecurity Analyst",
                        description: "Monitor and protect systems from security threats. Implement security measures and respond to incidents. Knowledge of network security and threat detection required.",
                        company: "SecureNet Defense",
                        email: "security-jobs@securenet.com",
                        approved: false
                    },
                    {
                        id: 1000008,
                        title: "Career Counselor",
                        description: "Provide career guidance and counseling to students. Assist with college applications, resume building, and interview preparation.",
                        company: "Future Pathways Institute",
                        email: "counseling@futurepathways.org",
                        approved: true
                    }
                ];
                
                savePostings(demoPostings);
            }
        }
        
        // Application modal functions
        function openApplicationModal(jobId) {
            const postings = getPostings();
            const job = postings.find(p => p.id === jobId);
            if (job) {
                const modal = document.getElementById('applicationModal');
                document.getElementById('modalJobTitle').textContent = `Apply for ${job.title}`;
                document.getElementById('jobId').value = jobId;
                modal.style.display = 'block';
                setTimeout(() => modal.classList.add('show'), 10);
                document.getElementById('applicationFormContainer').style.display = 'block';
                document.getElementById('applicationSuccess').style.display = 'none';
                document.body.style.overflow = 'hidden';

                // Update success message template with job match score
                const successDiv = document.getElementById('applicationSuccess');
                successDiv.innerHTML = `
                    <h3>Application Submitted!</h3>
                    <p>Thank you for your interest in <strong>${job.title}</strong> at <strong>${job.company}</strong>.</p>
                    <div class="ai-insights"></div>
                    <button onclick="closeApplicationModal()">Close</button>
                `;
            }
        }
        
        function closeApplicationModal() {
            document.getElementById('applicationModal').style.display = 'none';
            document.getElementById('applicationForm').reset();
            document.body.style.overflow = 'auto'; // Re-enable scrolling
        }
        
        // Get applications from local storage
        function getApplications() {
            return JSON.parse(localStorage.getItem('jobApplications')) || [];
        }
        
        // Save applications to local storage
        function saveApplications(applications) {
            localStorage.setItem('jobApplications', JSON.stringify(applications));
        }
        
        // Application form submission with AI processing
        document.getElementById('applicationForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Get form data
            const jobId = parseInt(document.getElementById('jobId').value);
            const name = document.getElementById('applicantName').value;
            const email = document.getElementById('applicantEmail').value;
            const phone = document.getElementById('applicantPhone').value;
            const coverLetter = document.getElementById('coverLetter').value;
            const heardAbout = document.getElementById('heardAbout').value;
            
            // Get the job posting
            const job = getPostings().find(p => p.id === jobId);
            
            if (!job) {
                alert('Job posting not found. Please try again.');
                return;
            }

            // Calculate AI match scores
            const matchScores = calculateJobMatch(job, { coverLetter });
            const suggestedJobs = generateJobSuggestions({ coverLetter })
                .filter(suggestion => suggestion.job.id !== jobId)
                .slice(0, 3);

            const application = {
                id: Date.now(),
                jobId: parseInt(jobId),
                name: name,
                email: email,
                phone: phone,
                coverLetter: coverLetter,
                heardAbout: heardAbout,
                dateApplied: new Date().toISOString(),
                status: 'pending',
                aiAnalysis: {
                    overall: matchScores.overall,
                    techSkillsScore: matchScores.techSkillsScore,
                    keywordScore: matchScores.keywordScore,
                    experienceScore: matchScores.experienceScore,
                    suggestedJobs
                }
            };
            
            // Get existing applications and add new one
            const applications = getApplications();
            applications.push(application);
            saveApplications(applications);
            
            // Update success message with detailed AI insights
            const successDiv = document.getElementById('applicationSuccess');
            const aiInsightsDiv = successDiv.querySelector('.ai-insights');
            
            aiInsightsDiv.innerHTML = `
                <h4>AI Match Analysis</h4>
                <div class="match-details">
                    <p><strong>Overall Match:</strong> ${Math.round(matchScores.overall * 100)}%</p>
                    <p><strong>Technical Skills Match:</strong> ${Math.round(matchScores.techSkillsScore * 100)}%</p>
                    <p><strong>Experience Level Match:</strong> ${Math.round(matchScores.experienceScore * 100)}%</p>
                    <p><strong>Keyword Match:</strong> ${Math.round(matchScores.keywordScore * 100)}%</p>
                </div>
                ${suggestedJobs.length > 0 ? `
                    <h4>Similar Jobs You Might Like</h4>
                    <ul class="suggested-jobs">
                        ${suggestedJobs.map(suggestion => `
                            <li>
                                <strong>${suggestion.job.title}</strong> at ${suggestion.job.company}
                                <p>Match Score: ${Math.round(suggestion.score.overall * 100)}%</p>
                                <button onclick="openApplicationModal(${suggestion.job.id})">Apply Now</button>
                            </li>
                        `).join('')}
                    </ul>
                ` : ''}
            `;
            
            // Show success message
            document.getElementById('applicationFormContainer').style.display = 'none';
            document.getElementById('applicationSuccess').style.display = 'block';
            
            // Reset form
            this.reset();
        });
        
        function renderApplications() {
            const applications = getApplications();
            const pendingApplications = document.getElementById('pendingApplications');
            const pendingCount = applications.filter(app => app.status === 'pending').length;
            
            pendingApplications.innerHTML = `<h3>Pending Applications (${pendingCount})</h3>`;
            
            if (pendingCount === 0) {
                pendingApplications.innerHTML += '<p>No pending applications at this time.</p>';
                return;
            }
            
            applications.forEach(application => {
                if (application.status === 'pending') {
                    const job = getPostings().find(p => p.id === application.jobId);
                    if (!job) return;
                    
                    const aiScores = application.aiAnalysis || {
                        overall: 0,
                        techSkillsScore: 0,
                        experienceScore: 0,
                        keywordScore: 0
                    };

                    pendingApplications.innerHTML += `
                        <div class="posting fade-in">
                            <h3>Application for ${job.title}</h3>
                            <p><strong>Applicant:</strong> ${application.name}</p>
                            <p><strong>Email:</strong> ${application.email}</p>
                            <p><strong>Phone:</strong> ${application.phone}</p>
                            <p><strong>Date Applied:</strong> ${new Date(application.dateApplied).toLocaleDateString()}</p>
                            <p><strong>Applicant's Reasoning:</strong></p>
                            <div class="cover-letter">
                                ${application.coverLetter}
                            </div>
                            <div class="ai-analysis">
                                <h4>AI Match Analysis</h4>
                                <p><strong>Overall Match:</strong> ${Math.round(aiScores.overall * 100)}%</p>
                                <p><strong>Technical Skills Match:</strong> ${Math.round(aiScores.techSkillsScore * 100)}%</p>
                                <p><strong>Experience Level Match:</strong> ${Math.round(aiScores.experienceScore * 100)}%</p>
                                <p><strong>Keyword Match:</strong> ${Math.round(aiScores.keywordScore * 100)}%</p>
                            </div>
                            <div class="application-actions">
                                <button onclick="approveApplication(${application.id})">Approve</button>
                                <button onclick="rejectApplication(${application.id})">Reject</button>
                                <button onclick="contactApplicant('${application.email}')">Contact Applicant</button>
                            </div>
                        </div>
                    `;

                }
            });
        }
        
        // Call renderApplications after form submission
        document.getElementById('applicationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            renderApplications(); // Add this line to update the display
        });
        
        // Function to approve an application
        function approveApplication(id) {
            const applications = getApplications();
            const applicationIndex = applications.findIndex(a => a.id === id);
            if (applicationIndex !== -1) {
                applications[applicationIndex].status = 'approved';
                saveApplications(applications);
                renderApplications();
            }
        }
        
        // Function to reject an application
        function rejectApplication(id) {
            const applications = getApplications();
            const updatedApplications = applications.filter(a => a.id !== id);
            saveApplications(updatedApplications);
            renderApplications();
            // Show feedback to user
            alert('Application rejected and removed successfully.');
        }

        // Function to contact an applicant
        function contactApplicant(email) {
            const encodedEmail = encodeURIComponent(email);
            const subject = encodeURIComponent("Regarding Your Application - School Guidance Job Board");
            const body = encodeURIComponent("Dear Applicant,\n\nThank you for your interest in our position. We would like to discuss your application further.\n\nBest regards,\nHiring Team");
            window.location.href = `mailto:${encodedEmail}?subject=${subject}&body=${body}`;
        }
        
        // Function to contact employer via email
        function contactEmployer(email) {
            const encodedEmail = encodeURIComponent(email);
            const subject = encodeURIComponent("Inquiry about Job Posting - School Guidance Job Board");
            const body = encodeURIComponent("Dear Hiring Manager,\n\nI am writing to inquire about the job position posted on the School Guidance Job Board. I would appreciate the opportunity to discuss this position further.\n\nBest regards");
            window.location.href = `mailto:${encodedEmail}?subject=${subject}&body=${body}`;
        }
        
        
        // Function to add demo applications
        function addDemoApplications() {
            const applications = getApplications();
            
            
                // Calculate AI scores before saving demo applications
                function calculateDemoApplicationScores(applications) {
                    const demoPostings = getPostings();
                    applications.forEach(application => {
                        const job = demoPostings.find(p => p.id === application.jobId);
                        if (job) {
                            const matchScores = calculateJobMatch(job, application);
                            application.aiAnalysis = {
                                overall: matchScores.overall,
                                techSkillsScore: matchScores.techSkillsScore,
                                experienceScore: matchScores.experienceScore,
                                keywordScore: matchScores.keywordScore
                            };
                        }
                    });
                }

                const demoApplications = [
                    {
                        id: 2000001,
                        jobId: 1000001,
                        name: "David Anderson",
                        email: "david.anderson@email.com",
                        phone: "555-0123",
                        coverLetter: "Im a new coder with little to no experience with only a little bit of Java experience.",
                        heardAbout: "School Counselor",
                        dateApplied: new Date(2024, 0, 15).toISOString(),
                        status: "pending"
                    },
                    {
                        id: 2000002,
                        jobId: 1000008,
                        name: "Maria Rodriguez",
                        email: "maria.counselor@email.com",
                        phone: "555-0124",
                        coverLetter: "With an M.Ed. in School Counseling and 5 years of experience working with diverse student populations, I am excited about the Career Counselor position at Future Pathways Institute. I've successfully guided over 200 students through college applications, resulting in a 95% college acceptance rate. My approach combines data-driven career assessment tools with empathetic one-on-one counseling to help students discover and pursue their ideal career paths. Support students' academic and social-emotional development. I can also Develop and implement comprehensive school counseling programs",
                        heardAbout: "Google Search", 
                        dateApplied: new Date(2024, 0, 14).toISOString(),
                        status: "pending"
                    },
                    {
                        id: 2000003,
                        jobId: 1000001,
                        name: "Jennifer Chen",
                        email: "j.chen@email.com",
                        phone: "555-0125",
                        coverLetter: "As a Software Engineer with 6 years of experience specializing in cloud architecture, I bring extensive expertise in AWS, microservices, and agile methodologies. At my current role, I led the migration of a monolithic application to a microservices architecture, improving system reliability by 40%. I'm particularly drawn to TechInnovate's focus on innovative solutions and collaborative culture.",
                        heardAbout: "Company Website",
                        dateApplied: new Date(2024, 0, 13).toISOString(),
                        status: "approved"
                    },
                    {
                        id: 2000004,
                        jobId: 1000002,
                        name: "Dr. Marcus Thompson",
                        email: "marcus.data@email.com",
                        phone: "555-0126",
                        coverLetter: "With a Ph.D. in Computer Science focusing on Machine Learning and 4 years of industry experience leading data science teams, I am excited about the Data Scientist position at DataVision Analytics. My research in neural networks has been published in top conferences, and I've implemented ML solutions that increased customer retention by 35% at my current company. I'm particularly interested in applying my expertise in deep learning and natural language processing to solve real-world business challenges.",
                        heardAbout: "Glassdoor",
                        dateApplied: new Date(2024, 0, 16).toISOString(),
                        status: "approved"
                    },
                    {
                        id: 2000005,
                        jobId: 1000003,
                        name: "Sophie Park",
                        email: "sophie.design@email.com",
                        phone: "555-0127",
                        coverLetter: "As a Senior UX/UI Designer with 8 years of experience and multiple industry awards, I am excited about joining DesignWorks Studio. My portfolio includes successful redesigns for Fortune 500 companies, resulting in average user engagement increases of 60%. I specialize in creating accessible, intuitive interfaces and have led design systems implementation for enterprise applications. My recent project increased mobile conversion rates by 45% through user-centered design principles.",
                        heardAbout: "Behance",
                        dateApplied: new Date(2024, 0, 12).toISOString(),
                        status: "approved"
                    },
                    {
                        id: 2000006,
                        jobId: 1000005,
                        name: "James Wilson",
                        email: "james.marketing@email.com",
                        phone: "555-0128",
                        coverLetter: "With 5 years of experience in digital marketing and a proven track record of growing brand presence across multiple channels, I am excited about the Marketing Coordinator position. I've managed campaigns that increased social media engagement by 150% and led to a 40% boost in lead generation. My experience includes successful collaboration with cross-functional teams to create integrated marketing strategies that align with business objectives.",
                        heardAbout: "School Counselor",
                        dateApplied: new Date(2024, 0, 17).toISOString(),
                        status: "pending"
                    }
                ];
                
                calculateDemoApplicationScores(demoApplications);
                saveApplications(demoApplications);
            }
        
        
        // Add demo postings and applications, then render
        addDemoPostings();
        addDemoApplications();
        renderPostings();
        renderApplications();
    </script>
    <script>
    // Debounce function to prevent excessive searches
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            clearTimeout(timeout); // Clear the timeout before setting a new one
            timeout = setTimeout(() => func(...args), wait); // Set the timeout to execute the function
        };
    }

    // Search functions
    function searchAdminPostings() {
        const searchTerm = document.getElementById('adminSearchInput').value.toLowerCase();
        const postings = getPostings();
        const applications = getApplications();
        const pendingList = document.getElementById('pendingApprovals');
        const adminApprovedList = document.getElementById('approvedPostings');
        const applicationsContainer = document.getElementById('pendingApplications');
        
        if (!searchTerm) {
            renderPostings();
            renderApplications();
            return;
        }
        
        // Enhance search results with relevance scores
        const enhancedPostings = enhanceSearchResults(searchTerm, postings);
        const enhancedApplications = applications.map(app => ({
            ...app,
            relevance: calculateRelevance(searchTerm, [
                app.name,
                app.email,
                app.coverLetter,
                postings.find(p => p.id === app.jobId)?.title || ''
            ])
        }));
        
        // Filter items based on relevance
        const filteredPostings = enhancedPostings.filter(p => p.relevance > 0);
        const filteredApplications = enhancedApplications.filter(a => a.relevance > 0);
        
        // Separate pending and approved postings
        const pendingPostings = filteredPostings.filter(p => !p.approved);
        const approvedPostings = filteredPostings.filter(p => p.approved);
        
        // Update pending postings
        pendingList.innerHTML = `<h3>Pending Approvals (${pendingPostings.length})</h3>`;
        if (pendingPostings.length === 0) {
            pendingList.innerHTML += `<p class="no-results">No pending postings match your search. Try different keywords.</p>`;
        }
        pendingPostings.forEach(posting => {
            const pendingHTML = `<div class="posting fade-in">
                <h3>${posting.title}</h3>
                <p>${posting.description}</p>
                <p><strong>Company:</strong> ${posting.company}</p>
                <p><strong>Contact:</strong> ${posting.email}</p>
                <button onclick="approvePosting(${posting.id})">Approve</button>
                <button onclick="deletePosting(${posting.id})">Delete</button>
            </div>`;
            pendingList.innerHTML += pendingHTML;
        });
        
        // Update approved postings
        adminApprovedList.innerHTML = `<h3>Approved Postings (${approvedPostings.length})</h3>`;
        if (approvedPostings.length === 0) {
            adminApprovedList.innerHTML += `<p class="no-results">No approved postings match your search.</p>`;
        } else {
            approvedPostings.forEach(posting => {
                const approvedHTML = `<div class="posting fade-in">
                    <h3>${posting.title}</h3>
                    <p>${posting.description}</p>
                    <p><strong>Company:</strong> ${posting.company}</p>
                    <p><strong>Contact:</strong> ${posting.email}</p>
                    <button onclick="deletePosting(${posting.id})">Delete</button>
                </div>`;
                adminApprovedList.innerHTML += approvedHTML;
            });
        }
        
        // Update applications
        applicationsContainer.innerHTML = `<h3>Applications (${filteredApplications.length})</h3>`;
        if (filteredApplications.length === 0) {
            applicationsContainer.innerHTML += `<p class="no-results">No applications match your search.</p>`;
        } else {
            filteredApplications.sort((a, b) => b.relevance - a.relevance).forEach(app => {
                const job = postings.find(p => p.id === app.jobId);
                const applicationHTML = `<div class="posting fade-in">
                    <div class="relevance-score">Match Score: ${Math.round(app.relevance * 100)}%</div>
                    <h3>${app.name} - ${job ? job.title : 'Unknown Position'}</h3>
                    <p><strong>Email:</strong> ${app.email}</p>
                    <p><strong>Phone:</strong> ${app.phone}</p>
                    <p><strong>Cover Letter:</strong> ${app.coverLetter}</p>
                    <p><strong>Status:</strong> ${app.status}</p>
                    <p><strong>Applied:</strong> ${new Date(app.dateApplied).toLocaleDateString()}</p>
                    <div class="button-group">
                        <button onclick="updateApplicationStatus(${app.id}, 'approved')">Approve</button>
                        <button onclick="updateApplicationStatus(${app.id}, 'rejected')">Reject</button>
                    </div>
                </div>`;
                applicationsContainer.innerHTML += applicationHTML;
            });
        }
    }
    
    function searchJobs() {
        const query = document.getElementById('searchInput').value.toLowerCase();
        const postings = getPostings();
        const approvedPostings = postings.filter(p => p.approved);
        
        if (!query) {
            renderPostings();
            return;
        }
        
        const enhancedResults = enhanceSearchResults(query, approvedPostings);
        
        const jobListings = document.getElementById('jobListings');
        jobListings.innerHTML = `<h2>Available Job Postings (${enhancedResults.length})</h2>`;
    
        if (enhancedResults.length === 0 || enhancedResults.every(result => result.relevance === 0)) {
            jobListings.innerHTML += `<p class="no-results">No job postings match your search. Try different keywords.</p>`;
            return;
        }
    
        enhancedResults.forEach(result => {
            const relevanceScore = result.relevance > 0 ? 
                `<div class="relevance-score">Match Score: ${Math.round(result.relevance * 100)}%</div>` : '';
            
            const postingHTML = `<div class="posting fade-in">
                ${relevanceScore}
                <h3>${result.title}</h3>
                <p>${result.description}</p>
                <p><strong>Company:</strong> ${result.company}</p>
                <p><strong>Contact:</strong> ${result.email}</p>
                <div class="button-group">
                    <button onclick="openApplicationModal(${result.id})">Apply Now</button>
                    <button onclick="contactEmployer('${result.email}')">Contact Employer</button>
                </div>
            </div>`;
            jobListings.innerHTML += postingHTML;
        });
    }

    // Add event listener for real-time search
    document.addEventListener('DOMContentLoaded', function () {
        const searchInput = document.getElementById('searchInput');
        if (searchInput) {
            searchInput.addEventListener('input', debounce(searchJobs, 300));
        }
    });
</script>
</body>
</html>
